---
# ============================================================================
# SUITE S1: POD E=80% bottleneck probe — V1 physics, MVAR p=5
# ============================================================================
#
# GOAL: First representation bottleneck probe on REAL V1 regime.
#       Compare POD energy=0.80 (fewer modes, lossy) vs V1's 0.90.
#       If R² drops significantly → POD ceiling is the bottleneck.
#       If R² barely changes → MVAR dynamics prediction is the bottleneck.
#
# BASE REGIME: V1 physics (best-performing slow regime)
#   speed=1.5, Ca=0.8, Cr=0.3, R=2.5, η=0.2
#
# OVERRIDES from V1:
#   - pod_energy: 0.80 (V1 was 0.90) — fewer modes, more compression
#   - Everything else identical
#
# POSTPROCESSING: Standard (clamp+renorm from pipeline defaults)
#   Logged via eval.clamp_negative=true (default in test_evaluator)
#
# EXPECTED: d ≈ 10-12 modes (V1 had ~19 at 90%)
#           R² likely lower than V1's +0.490 due to POD information loss
# ============================================================================

experiment_name: "suite_S1_podE80_raw_mvar_p5"

sim:
  N: 100
  T: 5.0
  dt: 0.04
  Lx: 15.0
  Ly: 15.0
  bc: "periodic"

model:
  type: "discrete"
  speed: 1.5
  speed_mode: "constant_with_forces"

params:
  R: 2.5

noise:
  kind: "gaussian"
  eta: 0.2
  match_variance: true

forces:
  enabled: true
  type: "morse"
  params:
    Ca: 0.8
    Cr: 0.3
    la: 1.5
    lr: 0.5
    mu_t: 0.3
    rcut_factor: 5.0

alignment:
  enabled: true

density:
  nx: 48
  ny: 48
  bandwidth: 4.0

outputs:
  density_resolution: 48
  density_bandwidth: 4.0

# Training ICs — IDENTICAL to V1
train_ic:
  type: "mixed_comprehensive"
  gaussian:
    enabled: true
    n_runs: 120
    positions_x: [3.0, 6.0, 9.0, 12.0]
    positions_y: [3.0, 6.0, 9.0, 12.0]
    variances: [0.8, 1.5, 2.5]
    n_samples_per_config: 2
  uniform:
    enabled: true
    n_runs: 50
    n_samples: 50
  two_clusters:
    enabled: true
    n_runs: 30
    separations: [3.0, 5.0, 7.0]
    sigmas: [1.0, 2.0]
    n_samples_per_config: 5
  ring:
    enabled: false

# Test ICs — IDENTICAL to V1
test_ic:
  type: "mixed_test_comprehensive"
  gaussian:
    enabled: true
    n_runs: 15
    test_positions_x: [4.5, 7.5, 10.5]
    test_positions_y: [4.5, 7.5, 10.5]
    test_variances: [1.2]
    n_samples_per_config: 1
    extrapolation_positions: [[2.0, 2.0], [13.0, 2.0], [2.0, 13.0], [13.0, 13.0], [7.5, 1.5], [1.5, 7.5]]
    extrapolation_variance: [1.2]
  uniform:
    enabled: true
    n_runs: 8
  two_clusters:
    enabled: true
    n_runs: 7
    test_separations: [4.0, 6.0]
    test_sigmas: [1.5]
    n_samples_per_config: 3
    extrapolation_separations: [2.0]
    extrapolation_sigma: [1.5]
  ring:
    enabled: false

rom:
  subsample: 3
  pod_energy: 0.80           # ← KEY CHANGE: 80% instead of V1's 90%

  models:
    mvar:
      enabled: true
      lag: 5
      ridge_alpha: 1.0e-4
    lstm:
      enabled: false

eval:
  metrics: ["r2", "rmse"]
  save_forecasts: true
  save_time_resolved: true
  forecast_start: 0.60        # Same as V1
