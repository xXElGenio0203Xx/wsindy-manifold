# ============================================================================
# ALVAREZ-STYLE ROM CONFIG - QUICK TEST VERSION
# ============================================================================
# Well-conditioned MVAR design with short test run (T=1.0s)
# After verification, use alvarez_style_production.yaml with T=8.0s
#
# Key design principles:
#   - Small latent space: d = 20 (fixed_modes)
#   - More KDE smoothing: bandwidth = 3.0 grid cells
#   - Short MVAR lag: w = 5 (good memory/parameter balance)
#   - Strong ridge regularization: alpha = 1e-4
#   - Mild eigenvalue scaling: threshold = 0.999
#   - Identifiability ratio ρ ≈ 15 (30,000 windows / 2,000 params)
# ============================================================================

# ---------------------------------------------------------------------------
# MICRO MODEL
# ---------------------------------------------------------------------------
sim:
  N: 40
  Lx: 15.0
  Ly: 15.0
  bc: "periodic"
  T: 1.0                    # QUICK TEST: 1 second only
  dt: 0.1
  v0: 1.0
  R: 2.0
  eta: 0.3

# ---------------------------------------------------------------------------
# DENSITY COMPUTATION (higher smoothing)
# ---------------------------------------------------------------------------
density:
  nx: 64
  ny: 64
  bandwidth: 3.0            # More smoothing → lower effective rank

# ---------------------------------------------------------------------------
# TRAINING ICs (reduced counts for quick test)
# ---------------------------------------------------------------------------
train_ic:
  gaussian:
    enabled: true
    n_runs: 5
    positions_x: [7.5]
    positions_y: [7.5]
    variances: [1.5]
    n_samples_per_config: 5
  
  uniform:
    enabled: true
    n_runs: 5
    n_samples: 5
  
  ring:
    enabled: true
    n_runs: 5
    radii: [4.0]
    widths: [0.5]
    n_samples_per_config: 5
  
  two_clusters:
    enabled: true
    n_runs: 5
    separations: [6.0]
    sigmas: [1.2]
    n_samples_per_config: 5

# ---------------------------------------------------------------------------
# TEST ICs (reduced counts for quick test)
# ---------------------------------------------------------------------------
test_ic:
  gaussian:
    enabled: true
    n_runs: 2
    test_positions_x: [9.0]
    test_positions_y: [9.0]
    test_variances: [1.5]
    extrapolation_positions: []
    extrapolation_variance: []
  
  uniform:
    enabled: true
    n_runs: 2
  
  ring:
    enabled: true
    n_runs: 2
    test_radii: [3.5]
    test_widths: [0.5]
    n_samples_per_config: 2
  
  two_clusters:
    enabled: true
    n_runs: 2
    test_separations: [5.0]
    test_sigmas: [1.2]
    extrapolation_separations: []
    extrapolation_sigma: []

# ---------------------------------------------------------------------------
# ROM: ALVAREZ-STYLE PARAMETERS
# ---------------------------------------------------------------------------
rom:
  energy_threshold: 0.98    # Diagnostic only
  latent_dim: 20            # FIXED: d = 20 modes

mvar:
  order: 5                  # Lag w = 5
  ridge_alpha: 1.0e-4       # Strong ridge regularization
  enforce_stability: true
  eigenvalue_threshold: 0.999  # Mild scaling
  train_fraction: 0.8

# ---------------------------------------------------------------------------
# EVALUATION
# ---------------------------------------------------------------------------
eval:
  forecast_dt: 1            # Evaluate every time step
  metrics:
    - "mse"
    - "mae"
    - "r2"
    - "mass_conservation"
