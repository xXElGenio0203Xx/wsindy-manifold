# ============================================================================
# ALVAREZ-STYLE ROM CONFIG - QUICK TEST VERSION
# ============================================================================
# Well-conditioned MVAR design with short test run (T=1.0s)
# After verification, use alvarez_style_production.yaml with T=8.0s
#
# Key design principles:
#   - Small latent space: d = 20 (fixed_modes)
#   - More KDE smoothing: bandwidth = 3.0 grid cells
#   - Short MVAR lag: w = 5 (good memory/parameter balance)
#   - Strong ridge regularization: alpha = 1e-4
#   - Mild eigenvalue scaling: threshold = 0.999
#   - Identifiability ratio ρ ≈ 15 (30,000 windows / 2,000 params)
# ============================================================================

# ---------------------------------------------------------------------------
# MICRO MODEL
# ---------------------------------------------------------------------------
sim:
  N: 40
  Lx: 15.0
  Ly: 15.0
  bc: "periodic"
  T: 1.0                    # QUICK TEST: 1 second only
  dt: 0.1
  v0: 1.0
  R: 2.0
  eta: 0.3

# ---------------------------------------------------------------------------
# DENSITY COMPUTATION (higher smoothing)
# ---------------------------------------------------------------------------
density:
  nx: 64
  ny: 64
  bandwidth: 3.0            # More smoothing → lower effective rank

# ---------------------------------------------------------------------------
# TRAINING ICs (reduced counts for quick test)
# ---------------------------------------------------------------------------
train_ic:
  n_train_per_type: 5       # Quick test: 5 per type = 20 total
  distributions:
    - type: "gaussian_cluster"
      params: {center_x: 7.5, center_y: 7.5, std: 1.5}
    - type: "uniform"
      params: {}
    - type: "ring"
      params: {radius: 4.0, std: 0.5}
    - type: "two_clusters"
      params: {separation: 6.0, std: 1.2}

# ---------------------------------------------------------------------------
# TEST ICs (reduced counts for quick test)
# ---------------------------------------------------------------------------
test_ic:
  n_test_per_type: 2        # Quick test: 2 per type = 8 total
  distributions:
    - type: "gaussian_cluster"
      params: {center_x: 9.0, center_y: 9.0, std: 1.5}
    - type: "uniform"
      params: {}
    - type: "ring"
      params: {radius: 3.5, std: 0.5}
    - type: "two_clusters"
      params: {separation: 5.0, std: 1.2}

# ---------------------------------------------------------------------------
# ROM: ALVAREZ-STYLE PARAMETERS
# ---------------------------------------------------------------------------
rom:
  energy_threshold: 0.98    # Diagnostic only
  latent_dim: 20            # FIXED: d = 20 modes

mvar:
  order: 5                  # Lag w = 5
  ridge_alpha: 1.0e-4       # Strong ridge regularization
  enforce_stability: true
  eigenvalue_threshold: 0.999  # Mild scaling
  train_fraction: 0.8

# ---------------------------------------------------------------------------
# EVALUATION
# ---------------------------------------------------------------------------
eval:
  forecast_dt: 1            # Evaluate every time step
  metrics:
    - "mse"
    - "mae"
    - "r2"
    - "mass_conservation"
