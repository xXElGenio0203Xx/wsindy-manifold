# ROM/MVAR Pipeline Configuration
#
# This config defines:
# 1. Base simulation parameters (Vicsek + Morse dynamics)
# 2. ROM training settings (ensemble size, POD, MVAR)
# 3. ROM evaluation settings (test ICs, metrics, visualization)
#
# Usage:
#   Train:    python scripts/rom_mvar_train.py --config configs/rom_mvar_example.yaml
#   Eval:     python scripts/rom_mvar_eval.py --experiment gentle_clustering --config configs/rom_mvar_example.yaml
#   Visualize: python scripts/rom_mvar_visualize.py --experiment gentle_clustering

# ==============================================================================
# Base simulation parameters
# ==============================================================================

seed: 0
model: social_force

sim:
  N: 100
  Lx: 20.0
  Ly: 20.0
  bc: periodic
  T: 50.0         # Simulation time
  dt: 0.01
  save_every: 5   # Save every 5 steps → 1000 total snapshots
  integrator: rk4
  neighbor_rebuild: 10

params:
  alpha: 1.5
  beta: 0.5
  Cr: 2.0
  Ca: 0.4       # Gentle attractive interactions
  lr: 0.9
  la: 1.0
  rcut_factor: 3.0
  mu_t: 1.0
  alignment:
    enabled: false

# Initial condition settings (for varied ICs in training/testing)
ic:
  type: uniform   # Will be overridden by different seeds

outputs:
  save_npz: true
  save_csv: true
  plots: false                # Disable plots during training/eval
  animate_traj: false         # No trajectory videos
  animate_density: false      # No density videos
  plot_order_params: false    # No order parameter plots
  
  grid_density:
    enabled: true
    nx: 64                    # Grid resolution for density
    ny: 64
    bandwidth: 0.5
  
  efrom:
    auto_run: false           # Don't run old EF-ROM pipeline

# ==============================================================================
# ROM training configuration
# ==============================================================================

rom:
  experiment_name: gentle_clustering
  rom_root: rom_mvar
  
  # Training ensemble
  num_train_ics: 10           # Number of training simulations with varied ICs
  train_seeds: null           # null = use range(num_train_ics), or explicit list
  
  # POD settings
  energy_threshold: 0.995     # Retain 99.5% of energy
  latent_dim: null            # null = use energy_threshold; int = fixed dimension
  
  # MVAR settings
  mvar_order: 4               # Number of lags
  ridge: 1.0e-6               # Ridge regularization
  train_frac: 1.0             # Use all time steps for training (1.0 = 100%)
  
  # Evaluation settings
  eval:
    num_test_ics: 2           # Number of unseen test ICs
    test_seeds: null          # null = use [1000, 1001, ...]; or explicit list
    forecast_horizon: null    # null = forecast to end of simulation
    error_tolerance: 0.1      # Tolerance for computing τ (tolerance horizon)
    error_metric: rmse        # Metric for τ: 'rmse', 'r2', 'e2', 'einf', 'mass_error'
    generate_videos: false    # False for Oscar, true for local
    generate_plots: false     # False for Oscar, true for local
